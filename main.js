(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(t,n){for(var r=0;r<n.length;r++){var o=n[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,(void 0,i=function(t,n){if("object"!==e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var o=r.call(t,"string");if("object"!==e(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(o.key),"symbol"===e(i)?i:String(i)),o)}var i}var n=function(){function e(t,n,r,o){var i=o.putLike,s=o.deleteLike,a=o.handleCardDelete,u=o.handleImageClick;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.putLike=i,this.deleteLike=s,this.templateSelector=n,this.name=t.name,this.link=t.link,this.likes=t.likes,this.cardId=t._id,this.userId=r,this.cardOwnerId=t.owner._id,this.isLike=null,this.btnLikeActiveClass="photo-elements__like-button_active",this.likeCounterDisabledClass="photo-elements__like-counter_disabled",this.likeContainerDisabledClass="photo-elements__like-container_disabled",this.handleCardDelete=a,this.handleImageClick=u}var n,r;return n=e,(r=[{key:"_getElement",value:function(){return document.querySelector(this.templateSelector).content.querySelector(".photo-elements__item").cloneNode(!0)}},{key:"_setEventListeners",value:function(){var e=this;this._btnLike.addEventListener("click",(function(t){e._handleLikeClick(t)})),this._cardImage.addEventListener("click",(function(){e.handleImageClick(e.name,e.link)})),this.userId===this.cardOwnerId?this._binBtnElement.addEventListener("click",(function(t){e.handleCardDelete(t.target,e.cardId)})):this._binBtnElement.remove()}},{key:"_showUserLike",value:function(){var e=this;this.likes&&this.likes.forEach((function(t){t._id===e.userId&&e._btnLike.classList.add(e.btnLikeActiveClass)}))}},{key:"_renderLikes",value:function(){0===this.likes.length?(this._likeContainer.classList.add(this.likeContainerDisabledClass),this._likeCounter.classList.add(this.likeCounterDisabledClass),this._likeCounter.textContent=this.likes.length.toString()):(this._likeContainer.classList.remove(this.likeContainerDisabledClass),this._likeCounter.classList.remove(this.likeCounterDisabledClass),this._likeCounter.textContent=this.likes.length.toString())}},{key:"_processLike",value:function(){var e=this,t=this.likes.some((function(t){return t._id===e.userId}));this.isLike=t}},{key:"_handleLikeClick",value:function(e){var t=this;return this._processLike(),this.isLike?this.deleteLike(this.cardId).then((function(n){e.target.classList.toggle(t.btnLikeActiveClass),t.likes=n.likes,t._renderLikes()})).catch((function(e){console.log("Ошибка при отправке данных о лайке на сервер: ".concat(e.message))})):this.putLike(this.cardId).then((function(n){e.target.classList.toggle(t.btnLikeActiveClass),t.likes=n.likes,t._renderLikes()})).catch((function(e){console.log("Ошибка при отправке данных о лайке на сервер: ".concat(e.message))}))}},{key:"generate",value:function(){return this.element=this._getElement(),this._cardImage=this.element.querySelector(".photo-elements__image"),this._btnLike=this.element.querySelector(".photo-elements__like-button"),this._likeContainer=this.element.querySelector(".photo-elements__like-container"),this._likeCounter=this.element.querySelector(".photo-elements__like-counter"),this._binBtnElement=this.element.querySelector(".photo-elements__bin-button"),this.element.querySelector(".photo-elements__title").textContent=this.name,this._cardImage.src=this.link,this._cardImage.alt=this.name,this._renderLikes(),this._showUserLike(),this._setEventListeners(),this.element}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(void 0,i=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,"string");if("object"!==r(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(o.key),"symbol"===r(i)?i:String(i)),o)}var i}var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._handleEscClose=this._handleEscClose.bind(this),this._handleOverlayClose=this._handleOverlayClose.bind(this),this.popup=document.querySelector(t)}var t,n;return t=e,(n=[{key:"open",value:function(){this.popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this.popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleOverlayClose",value:function(e){e.target===e.currentTarget&&this.close(e.target)}},{key:"setEventListeners",value:function(){var e=this;this.popup.addEventListener("mousedown",this._handleOverlayClose),this.popup.querySelector(".popup__btn-close").addEventListener("click",(function(){e.close()}))}}])&&o(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==s(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==s(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===s(o)?o:String(o)),r)}var o}function u(){return u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=l(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},u.apply(this,arguments)}function l(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}function f(e,t){if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function p(e){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},p(e)}var h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=p(r);if(o){var n=p(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return f(this,e)});function s(e){var t,n=e.popupSelector,r=e.popupImagePictureSelector,o=e.popupImageCaptionSelector;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,n)).popup=document.querySelector(n),t.image=t.popup.querySelector(r),t.caption=t.popup.querySelector(o),t}return t=s,(n=[{key:"open",value:function(e,t){u(p(s.prototype),"open",this).call(this),this.image.src=t,this.image.alt=e,this.caption.textContent=e}}])&&a(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i);function d(e){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},d(e)}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==d(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==d(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===d(o)?o:String(o)),r)}var o}function m(){return m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=b(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},m.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=S(e)););return e}function v(e,t){return v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},v(e,t)}function _(e,t){if(t&&("object"===d(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e){return S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},S(e)}var k=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=S(r);if(o){var n=S(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function s(e,t){var n,r=t.handleSubmitForm,o=t.showLoader,a=t.hideLoader;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(n=i.call(this,e)).popup=document.querySelector(e),n._form=n.popup.querySelector(".form"),n.handleSubmitForm=r,n._submitHandler=n._submitHandler.bind(g(n)),n.showLoader=o,n.hideLoader=a,n}return t=s,(n=[{key:"_getInputValues",value:function(){var e=this;return this._formValues={},this._inputList.forEach((function(t){return e._formValues[t.name]=t.value})),this._formValues}},{key:"setInputValues",value:function(e){this._inputList.forEach((function(t){t.value=e[t.name]}))}},{key:"_submitHandler",value:function(e){var t=this;e.preventDefault(),this.showLoader(),this.handleSubmitForm(this._getInputValues()).then(this.close()).catch((function(e){console.log("Ошибка при отправке обновленных данных пользователя: ".concat(e.message))})).finally((function(){t.hideLoader()}))}},{key:"setEventListeners",value:function(){m(S(s.prototype),"setEventListeners",this).call(this),this._inputList=this._form.querySelectorAll(".form__input"),this._form.addEventListener("submit",this._submitHandler)}},{key:"close",value:function(){m(S(s.prototype),"close",this).call(this),this._form.reset()}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==w(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==w(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===w(o)?o:String(o)),r)}var o}function L(){return L="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=O(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},L.apply(this,arguments)}function O(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=I(e)););return e}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}function j(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return P(e)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}var T=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&C(e,t)}(s,e);var t,n,r,o,i=(r=s,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=I(r);if(o){var n=I(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return j(this,e)});function s(e){var t,n=e.popupSelector,r=e.btnAgreeDeleteSelector,o=e.handleCardDelete;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,n)).btnAgreeDelete=document.querySelector(r),t.setAgreeBtnEventListener=t.setAgreeBtnEventListener.bind(P(t)),t.handleCardDelete=o,t.binBtn=null,t.cardId=null,t}return t=s,(n=[{key:"setAgreeBtnEventListener",value:function(){this.handleCardDelete(this.binBtn,this.cardId)}},{key:"open",value:function(e,t){L(I(s.prototype),"open",this).call(this),this.binBtn=e,this.cardId=t,this.btnAgreeDelete.addEventListener("click",this.setAgreeBtnEventListener)}},{key:"close",value:function(){L(I(s.prototype),"close",this).call(this),this.btnAgreeDelete.removeEventListener("click",this.setAgreeBtnEventListener)}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),s}(i);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==R(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==R(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===R(o)?o:String(o)),r)}var o}var A=function(){function e(t){var n=t.items,r=t.renderer,o=t.containerSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=n,this._renderer=r,this._container=document.querySelector(o)}var t,n;return t=e,(n=[{key:"renderNewItem",value:function(e){this._renderer(e)}},{key:"renderItems",value:function(e){var t=this;this._renderedItems=e,this._renderedItems.reverse().forEach((function(e){return t._renderer(e)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function B(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==D(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==D(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===D(o)?o:String(o)),r)}var o}var U=function(){function e(t){var n=t.profileName,r=t.profileAbout,o=t.avatar;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.nameElement=n,this.aboutElement=r,this.avatarElement=o}var t,n;return t=e,n=[{key:"getUserInfo",value:function(){return{name:this._name,about:this._about,avatar:this._avatar,_id:this._id}}},{key:"_updateAvatar",value:function(){this.avatarElement.src=this._avatar}},{key:"_updateUserInfo",value:function(){this.nameElement.textContent=this._name,this.aboutElement.textContent=this._about}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.about,r=e.avatar,o=e._id;this._name=t,this._about=n,this._avatar=r,this._userId=o,this._updateUserInfo(),this._updateAvatar()}}],n&&B(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e){return x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==x(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==x(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===x(o)?o:String(o)),r)}var o}var N=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.classSettings=t,this.formElement=n}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListeners()}},{key:"_setEventListeners",value:function(){var e=this;this.inputList=Array.from(this.formElement.querySelectorAll(this.classSettings.inputSelector)),this.buttonElement=this.formElement.querySelector(this.classSettings.submitButtonSelector),this._setSubmitBtnState(),this.inputList.forEach((function(t){t.addEventListener("input",(function(){e._isValid(t),e._setSubmitBtnState()}))}))}},{key:"_isValid",value:function(e){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(){return this.inputList.some((function(e){return!e.validity.valid}))}},{key:"_setSubmitBtnState",value:function(){this._hasInvalidInput()?(this.buttonElement.disabled=!0,this.buttonElement.classList.add(this.classSettings.inactiveButtonClass)):(this.buttonElement.disabled=!1,this.buttonElement.classList.remove(this.classSettings.inactiveButtonClass))}},{key:"_showInputError",value:function(e,t){this.errorElement=this.formElement.querySelector(".".concat(e.id,"-error")),e.classList.add(this.classSettings.inputErrorClass),this.errorElement.textContent=t,this.errorElement.classList.add(this.classSettings.errorVisibleClass)}},{key:"_hideInputError",value:function(e){this.errorElement=this.formElement.querySelector(".".concat(e.id,"-error")),e.classList.remove(this.classSettings.inputErrorClass),this.errorElement.classList.remove(this.classSettings.errorVisibleClass),this.errorElement.textContent=""}},{key:"resetErrorOnReOpen",value:function(){var e=this;this.inputList.forEach((function(t){e._hideInputError(t)}))}},{key:"disableSubmitBtnOnOpen",value:function(){this.buttonElement.setAttribute("disabled",!0),this.buttonElement.classList.add(this.classSettings.inactiveButtonClass)}}])&&V(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function F(e){return F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},F(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==F(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!==F(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key),"symbol"===F(o)?o:String(o)),r)}var o}var J=function(){function e(t){var n=t.baseUrl,r=t.headers;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.baseUrl=n,this.headers=r}var t,n;return t=e,(n=[{key:"getResponse",value:function(e){return e.ok?e.json():Promise.reject("Ошибка: ".concat(e.status))}},{key:"getUserData",value:function(){return fetch("".concat(this.baseUrl,"/users/me"),{headers:this.headers}).then(this.getResponse)}},{key:"patchProfile",value:function(e,t){return fetch("".concat(this.baseUrl,"/users/me"),{method:"PATCH",headers:this.headers,body:JSON.stringify({name:e,about:t})}).then(this.getResponse)}},{key:"patchAvatar",value:function(e){return fetch("".concat(this.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:e})}).then(this.getResponse)}},{key:"getCards",value:function(){return fetch("".concat(this.baseUrl,"/cards"),{headers:this.headers}).then(this.getResponse)}},{key:"postCard",value:function(e,t){return fetch("".concat(this.baseUrl,"/cards"),{method:"POST",headers:this.headers,body:JSON.stringify({name:e,link:t})}).then(this.getResponse)}},{key:"deleteCard",value:function(e){return fetch("".concat(this.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({_id:e})}).then(this.getResponse)}},{key:"putLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this.headers,body:JSON.stringify({_id:e})}).then(this.getResponse)}},{key:"deleteLike",value:function(e){return fetch("".concat(this.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this.headers,body:JSON.stringify({_id:e})}).then(this.getResponse)}}])&&H(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),M={btnTextOriginal:"",btnTextLoading:"Сохранение ..."},z=function(e){return function(e){M.btnTextOriginal=e.textContent}(e),e.textContent=M.btnTextLoading},$=function(e){return e.textContent=M.btnTextOriginal},G=document.querySelector(".profile__name"),K=document.querySelector(".profile__about"),Q=document.forms.profile,W=document.forms.card,X=document.querySelector(".popup_profile"),Y=document.querySelector(".popup_image-window"),Z=document.querySelector(".popup_agree-delete");function ee(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var te,ne=document.querySelector(".profile__avatar"),re=document.querySelector(".profile__avatar-container"),oe=document.querySelector(".popup_edit-avatar"),ie=document.forms.avatar,se=ie.elements.submitAvatar,ae=document.querySelector(".profile__edit-button"),ue=Q.elements.submitProfile,le=document.querySelector(".profile__add-button"),ce=document.querySelector(".popup_new-place"),fe=W.elements.submitPlace;document.addEventListener("DOMContentLoaded",(function(){X.classList.add("popupTransitions"),ce.classList.add("popupTransitions"),Y.classList.add("popupTransitions"),oe.classList.add("popupTransitions"),Z.classList.add("popupTransitions")}));var pe=new J({baseUrl:"https://nomoreparties.co/v1/plus-cohort-19",headers:{authorization:"858c7cb6-e0c3-4a29-bdeb-66efeccdb118","Content-Type":"application/json"}}),he={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit-btn",inactiveButtonClass:"form__submit-btn_disabled",inputErrorClass:"form__input_type_error",errorClass:"form__input-error-message",errorVisibleClass:"form__input-error-message_active"},de=new N(he,Q);de.enableValidation();var ye=new N(he,W);ye.enableValidation();var me=new N(he,ie);me.enableValidation();var be=new U({profileName:G,profileAbout:K,avatar:ne}),ve=new k(".popup_edit-avatar",{handleSubmitForm:function(e){var t=e.avatar;return pe.patchAvatar(t).then((function(e){be.setUserInfo(e)}))},showLoader:function(){z(se)},hideLoader:function(){$(se)}});ve.setEventListeners();var _e=new k(".popup_profile",{handleSubmitForm:function(e){var t=e.name,n=e.about;return pe.patchProfile(t,n).then((function(e){be.setUserInfo(e)}))},showLoader:function(){z(ue)},hideLoader:function(){$(ue)}});_e.setEventListeners();var ge=new k(".popup_new-place",{handleSubmitForm:function(e){var t=e.place,n=e.link;return pe.postCard(t,n).then((function(e){we.renderNewItem(e)}))},showLoader:function(){z(fe)},hideLoader:function(){$(fe)}});ge.setEventListeners();var Se=new h({popupSelector:".popup_image-window",popupImagePictureSelector:".popup__image",popupImageCaptionSelector:".popup__caption"});Se.setEventListeners();var ke=new T({popupSelector:".popup_agree-delete",btnAgreeDeleteSelector:".popup__btn-agree",handleCardDelete:function(e,t){return pe.deleteCard(t).then((function(){ke.close(),e.closest(".photo-elements__item").remove()})).catch((function(e){console.log("Ошибка при удалении карточки: ".concat(e.message))}))}});ke.setEventListeners();var we=new A({items:[],renderer:function(e){var t=new n(e,"#photo-cards-template",te,{putLike:function(e){return pe.putLike(e)},deleteLike:function(e){return pe.deleteLike(e)},handleCardDelete:function(e,t){ke.open(e,t)},handleImageClick:function(e,t){Se.open(e,t)}}).generate();we.addItem(t)},containerSelector:".photo-elements__list"});Promise.all([pe.getUserData(),pe.getCards()]).then((function(e){var t,n,r,o=(r=2,function(e){if(Array.isArray(e))return e}(n=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,s,a=[],u=!0,l=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){l=!0,o=e}finally{try{if(!u&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw o}}return a}}(n,r)||function(e,t){if(e){if("string"==typeof e)return ee(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ee(e,t):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=o[0],s=o[1];t=i._id,te=t,be.setUserInfo(i),we.renderItems(s)})).catch((function(e){console.log("Ошибка при загрузке данных пользователя с сервера: ".concat(e.message))})),re.addEventListener("click",(function(){ie.reset(),me.resetErrorOnReOpen(),me.disableSubmitBtnOnOpen(),ve.open()})),ae.addEventListener("click",(function(){de.resetErrorOnReOpen(),de.disableSubmitBtnOnOpen(),_e.setInputValues(be.getUserInfo()),_e.open()})),le.addEventListener("click",(function(){W.reset(),ye.resetErrorOnReOpen(),ye.disableSubmitBtnOnOpen(),ge.open()}))})();